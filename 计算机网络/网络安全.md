## **对称加密与非对称加密**

#### (1) 对称加密

对称加密是通信双方共同拥有一把密钥。

这把密钥可以把明文加密(encryption)成密文，也可以把密文解密(decryption)成明文。

对称加密的优点是：速度快。

同时也有一个缺点，就是不那么安全，一旦你的密钥被别人窃取了，所有的数据就会在网络的世界里裸奔。

#### (2) 非对称加密

与对称加密相对的是 非对称加密。

通信双方持有不同的密钥。

**服务端的密钥，称之为 私钥(private key)**，**客户端的密钥，称之为 公钥 (public key)。**

他们二者的区别是：

- 私钥应仅在服务端保存，绝不可泄露。而公钥可以存在于任何的客户端，即使黑客拿到了也没有关系。
- **公钥加密的密文只有相对应的私钥才能解密**
- [![img](https://s3.51cto.com/oss/202010/18/cdec162b613b040b360cbf9748662958.jpg)](https://s3.51cto.com/oss/202010/18/cdec162b613b040b360cbf9748662958.jpg)

- 私钥加密的内容，所有与之相对应的公钥都能解密。
- **私钥通常用来生成签名，公钥用来验证签名。**
- [![img](https://s2.51cto.com/oss/202010/18/cf95520ff75b72357f957726acfe1339.jpg)](https://s2.51cto.com/oss/202010/18/cf95520ff75b72357f957726acfe1339.jpg)

- 公钥和私钥是相对的，两者本身并没有规定哪一个必须是公钥或私钥。这意味着，公钥只要不对外公开，那就可以做为私钥，私钥公开后也可以做为公钥。

典型的非对称加密算法有 RSA 。

非对称加密的优点，就是安全系数特别高。缺点就是速度会慢一些。

## **摘要、签名、证书是啥?**

#### (1) 信息摘要(digest)

一段信息，经过摘要算法得到一串哈希值，就是摘要(dijest)。

常见的摘要算法有MD5、SHA1、SHA256、SHA512等。

关于摘要，有几点需要你明白的：

- 摘要算法，是把任意长度的信息，映射成一个定长的字符串。
- 摘要算法，两个不同的信息，是有可能算出同一个摘要值的。
- 摘要算法与加密算法不同，不存在解密的过程。
- 摘要算法不用于数据的保密，而是用于数据的完整性校验。

#### (2) 数字签名

**摘要经过私钥的加密后，便有了一个新的名字 -- 数字签名。**

- 签名 是在发送方，这是一个加密的过程。
- 验签 是在接收方，这是一个解密的过程。

那搞懂数字签名的意义是什么?只要回答下面两个问题即可。

第一个问题，有了信息摘要，为何还要有数字签名?

答：信息摘要，虽然也不可逆，但却容易却被伪造。所以信息摘要只用于校验完整性，而要保证信息摘要的正确性，就要依靠数字签名啦。

**数字签名的签名和验签是非对称加密，其他人除非拿到私钥，不然没法伪造。**

第二个问题，为什么不对内容直接加密，而是对摘要进行加密。

答：由上面我们知道了非对称加密的速度非常慢，如果传输的数据量非常大，那这个加密再解密的时间要远比网络传输的时间来得长，这样反而会得不偿失。

如果我们对传输的内容只有完整性要求，而安全性没有要求(意思是传输的内容被人知道了也没关系)。那就可以对摘要进行加密，到客户端这里解密后得到摘要明文，再用这个摘要明文与传输的数据二次计算的摘要进行比较，若一致，则说明传输的内容是完整的，没有被篡改。

#### (3) 数字证书   (数字证书，为了避免公钥被中间人冒充篡改：)

在数字签名那里，不知道你有没有发现一个问题?

数字签名是非对称加密，服务端有一个私钥，客户端一个公钥，只有这两个对上了验签。

那假如说你(客户端)拿到的公钥并不是服务端给的呢，而是黑客塞给你的呢?而你却把这个假公钥当成真的，那么当你使用这个假公钥加密一些敏感信息时，黑客就可以截取你的这段信息，由于这信息是用黑客自己的公钥加密的，这样一来，黑客拿自己的私钥就能解密得到你的敏感信息。

这就是问题所在。

要解决这个问题，**其实只要保证『公钥』是可信的。只有服务端发给你的公钥你才能拿**，而坏人给你的公钥，你要懂得识别并丢弃它。

[![img](https://s2.51cto.com/oss/202010/18/ec39d3140655924d686931a1d06f0616.jpg)](https://s2.51cto.com/oss/202010/18/ec39d3140655924d686931a1d06f0616.jpg)

数字证书就应运而生了。

要理解数字证书，同样只要搞懂两个问题即可。

- 数字证书是什么东西?其实它就是一个 .crt 文件
- **数字证书是谁颁发的?由权威证书认证机构颁发，一般我们简称为 CA 机构**
- 数字证书如何申请的?或者说如何颁发的?

为了让你理解这一过程，我画了下面这张图：

[![img](https://s2.51cto.com/oss/202010/18/77a47b55ce37018d34477f51c4932417.jpg)](https://s2.51cto.com/oss/202010/18/77a47b55ce37018d34477f51c4932417.jpg)

- 在自己的服务器上生成一对公钥和私钥。然后将域名、申请者、公钥(注意不是私钥，私钥是无论如何也不能泄露的)等其他信息整合在一起，生成.csr 文件。
- 将这个 .csr 文件发给 CA 机构，CA 机构收到申请后，会通过各种手段验证申请者的组织信息和个人信息，如无异常(组织存在，企业合法，确实是域名的拥有者)，CA 就会使用散列算法对.csr里的明文信息先做一个HASH，得到一个**信息摘要**，再用 **CA 自己的私钥对这个信息摘要进行加密**，生成一串密文，密文即是所说的 **签名**。签名 + .csr 明文信息，即是 证书。CA 把这个证书返回给申请人。

![img](http://mianbaoban-assets.oss-cn-shenzhen.aliyuncs.com/xinyu-images/MBXY-CR-203531ea8afd45f9e5977a413fdf0d39.png)